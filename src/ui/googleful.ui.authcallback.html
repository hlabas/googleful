<html>
<head>
  <title>Authorization of Contentful</title>
  <style>
  body {
    font-family: Arial, sans-serif;
    font-size: 14pt;
    font-weight: bold;
    background-color: rgb(214, 220, 228);
    color: rgb(45, 47, 49);
    text-align: center;
    padding: 40px;
  }
  </style>
</head>
<body>
  <div id="msg">Authorization is in progress...</div>
</body>
<script>window.onload = sendToken;
  function sendToken() {
    google.script.url.getLocation(function(loc) {
      var token = loc.hash.split('&')[0].split('=')[1];
      google.script.run.withSuccessHandler(function () {
        document.querySelector('#msg').textContent = 'Authorization was successful, you may now close this window.';
      }).call(
      'AuthCallback', 'setToken',
      [token]
    );
  });
};
</script>
</html>
