<script>

function refreshContentTypes() {
  $('#refresh-link').text('Loading...');
  google.script.run
      .withSuccessHandler(refreshContentTypesSuccess)
      .call('Home', 'refreshContentTypes');
}

function initWithContentType() {
  google.script.run
      .withSuccessHandler(initWithContentTypeSuccess)
      .call('Home', 'initSheet', [$('#contentType').val()]);
}

function refreshContentTypesSuccess(contentTypes) {
  $('#refresh-link').text('Refresh');
  var $ct = $('#contentType');
  $ct.empty();
  for (var i = 0; i < contentTypes.items.length; i++) {
    var ct = contentTypes.items[i];
    $ct.append($('<option>', {
      value: ct.sys.id,
      text: ct.name
    }));
  }
}

function initWithContentTypeSuccess(result) {
  confirm('The spreadsheet has been successfully intialized.');
}
</script>
